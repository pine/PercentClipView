language: android
jdk:
  - oraclejdk8
addons:
  apt:
    packages:
      - lynx
env:
  - GRADLE_OPTS="-Xmx512m -XX:MaxPermSize=512m"

android:
  components:
    - tools
    - platform-tools
    - build-tools-25.0.3
    - android-25
    - sys-img-armeabi-v7a-android-22

  licenses:
    - android-sdk-license-.+

before_script:
  - echo no | android create avd --force -n test -t android-22 --abi armeabi-v7a
  - emulator -avd test -no-audio -no-window &
  - android-wait-for-emulator
  - adb shell input keyevent 82 &

script:
  - ./gradlew clean build connectedCheck

after_failure:
  - |
      if [ -f "$TRAVIS_BUILD_DIR/percent-clip-view/build/reports/lint-results.html" ]; then
        lynx -dump "$TRAVIS_BUILD_DIR/percent-clip-view/build/reports/lint-results.html"
      fi
